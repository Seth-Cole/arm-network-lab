Test deploy BICEP templates in azure

Cmdlets used

Create resource group:
	New-AzResourceGroup -Location <System.String> -Name <System.String>
		-Location - Specifies the location of the resource group. Specify an Azure data center location, such as West US or Southeast Asia.
		-Name -  Specifies a name for the resource group. The resource name must be unique in the subscription.

	New-AzResourceGroupDeployment -ResourceGroupName <System.String> -TemplateFile <System.String> -TemplateParameterFile <System.String -WhatIf <System.Management.Automation.SwitchParameter>
		-ResourceGroupName - Accepts pipeline input
		-TemplateFile	- Specifies the full path of a custom template file. Supported template file type: json and bicep
		-TemplateParameterFile - Specifies the full path of a JSON file that contains the names and values of the template parameters
		-WhatIf - Shows what would happen if the cmdlet runs. The cmdlet is not run.


--Preference_Variables--

$ErrorActionPreference

1. What does `$ErrorActionPreference = 'Stop'` do?
	Displays the error message and stops executing

2. What are the other options? (Continue, SilentlyContinue, Inquire)
	Break
	Continue
	Ignore
	Inquire
	SilentlyContinue

3. Which is best for a deployment script that should fail fast?
	Stop

--Parameter Syntax--

1. How do I create a parameter with a default value?
	PSDefaultValue (-Help) and (Value)
2. How do I make a parameter mandatory?
3. How do I validate parameter values?



## Step 4 (Make sure target files exist before trying to use them)



** Test-Path ** 
	-Determines whether all elements of a path exist.

What does Test-Path return? (True/False)
	$true - if all elements exist
	$false - if any are missing

How do you use it to check if a file exists?
		Test-Path -LiteralPath $TemplateFile
				or
		Test-Path -Path $TempalteFile

What parameter tells it you're checking a file vs a directory?

-PathType Leaf
	either Container, Leaf, Any
		Container = Directory/Registry Key
		Leaf = Element doesn't contain other elements, File
		Any = Either Container or Leaf
	
** about_Throw **
Describes the throw keyword that generates a terminating error

The throw keyword causes a terminating error. You can use the throw keyword to stop the processing of a command, function, or script

you can use the throw keyword in the statement block of an if statement to respond to a condition or in the catch block of a try/catch/finally statement


How do you stop a script with custom error messages?
	throw [<expression>]
	
		if Test-Path -neq $true
			throw "This file doesn't exist"


** If Statement **

You can use the if statement to run code blocks if a specified conditional test evaluates to true. You can also specify one or more additional conditional tests to run if all the prior tests evaluate to false. Finally,you can specify an additional code block that's run if no other prior conditional test evaluates to true.

    if (<test1>)
        {<statement list 1>}
    [elseif (<test2>)
        {<statement list 2>}]
    [else
        {<statement list 3>}]


## Step 5: Preflight Checks

You need to validate two things before running the what-if:
User is logged into Azure
Target resource group exists

** Get-Help Get-AzContext -Full **
Gets the metadata used to authenticate Azure Resource Manager requests

What does Get-AzContext return when you're logged in?
	- gets the Active Directory account, Active Directory tenant, Azure subscription, and the targeted Azure environment.
What does it return when you're NOT logged in?
	$null ?
	
How do you check if the result is null/empty?
	-ListsAvailable?
